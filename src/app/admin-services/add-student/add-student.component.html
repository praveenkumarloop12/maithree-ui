<div class="container card" style="border: #e3e3e3 solid 1px;padding: 20px 40px;">
  <div class="row">
    <div class="col-lg-12">
      <h4 style="margin: auto 0">Add Student
        <span style="float: right">
          <a style="border-radius: 40px;" class="tablinks btn btn-outline-primary"
          routerLink="/admin-dashboard/update-student">Update Student</a>
        </span>
      </h4>
    </div>
  </div>
  <hr>
  <br />
  <form (ngSubmit)="onSubmit(studentForm)" #studentForm="ngForm" class="form-horizontal">
    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="branchId">Branch:</label>
          <div class="col-sm-12">
            <select required [(ngModel)]="studentRequest.branchId" class="form-control" name="branchId"
              (ngModelChange)="getDetailsForSelectedBranch($event)" #branchId="ngModel">
              <option style="text-align: center" disabled selected value="0">Select Branch</option>
              <option *ngFor="let branch of branchList;" [value]="branch.id" style="text-align: center">
                {{branch.name}}</option>
            </select>
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="memberId">Teacher:</label>
          <div class="col-sm-12">
            <select required [disabled]="studentRequest.branchId==0" [(ngModel)]="studentRequest.memberId" class="form-control" name="memberId"
              #memberId="ngModel">
              <option style="text-align: center" disabled selected value="0">Select Teacher</option>
              <option *ngFor="let mem of teachersList;" [value]="mem.id" style="text-align: center">
                {{mem.name}}</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="firstName">First Name:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.firstName" type="text" class="form-control"
              placeholder="Enter first name" name="firstName" #firstName="ngModel">
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="middleName">Middle Name:</label>
          <div class="col-sm-12">
            <input [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.middleName" type="text" class="form-control"
              placeholder="Enter middle name" name="middleName" #middleName="ngModel">
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="lastName">Last Name:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.lastName" type="text" class="form-control"
              placeholder="Enter last name" name="lastName" #lastName="ngModel">
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-12" for="dob">Date of Birth:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.dob" type="date" class="form-control"
              placeholder="Enter date of brith" name="dob" #dob="ngModel">
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="guardainName">Guardian Name:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.guardainName" type="guardainName" class="form-control"
              placeholder="Enter guardian name" name="guardainName" #guardainName="ngModel">
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="phoneNumber">Phone Number:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.phoneNumber" type="text" class="form-control"
              placeholder="XXX XXXX XXX" name="phoneNumber" #phoneNumber="ngModel">
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="emailAddress">Email Address:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.emailAddress" type="email" class="form-control"
              placeholder="Enter email id" name="emailAddress" #emailAddress="ngModel">
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="state">State:</label>
          <div class="col-sm-12">
            <select required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.state" name="state" class="form-control" #state="ngModel">
              <option *ngFor="let state of states;" [value]="state.key"> {{state.name}}</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="address">Address:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.address" type="text" class="form-control"
              placeholder="Enter address" name="address" #address="ngModel">
          </div>
        </div>
      </div>
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="gender">Gender:</label>
          <div class="col-sm-12">
            <div class="btn-group btn-group-toggle" data-toggle="buttons">
              <label class="btn btn-outline-primary" [ngClass]="{active: (studentRequest.gender=='M')}"
                (click)="studentRequest.gender='M'">
                <input type="radio" [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.gender" [value]="M" name="gender"> Male
              </label>
              <label class="btn btn-outline-primary" [ngClass]="{active: (studentRequest.gender=='F')}"
                (click)="studentRequest.gender='F'">
                <input type="radio" [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.gender" name="gender" [value]="F"> Female
              </label>
            </div>
          </div>
        </div>
      </div>

    </div>
    <div class="row">
      <div class="col-sm-6">
        <div class="form-group">
          <label class="control-label col-sm-4" for="pincode">Pincode:</label>
          <div class="col-sm-12">
            <input required [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="studentRequest.pincode" type="text" class="form-control" placeholder="XXX XXX"
              name="pincode" #pincode="ngModel" pattern="[0-9]{6}">
          </div>
        </div>
      </div>
    </div>

    <div class="row"
      style="background: #f1f1f1;border-radius: 15px;margin-top: 10px; margin-bottom: 20px;padding: 20px 20px;">
      <div class="col-sm-12">
        Assign task
        <hr>
      </div>

      <div class="input-group col-sm-5">
        <div class="input-group-prepend">
          <span class="input-group-text">Product</span>
        </div>
        <select [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" [(ngModel)]="taskmapping.productSelected" name="productSelected"
          (change)="getTasksForSelectedProduct(taskmapping.productSelected)" class="form-control">
          <option value="0" selected disabled>Select Product</option>
          <option *ngFor="let product of productList;" [value]="product.id" style="text-align: center">
            {{product.name}}</option>
        </select>
      </div>
      <div class="input-group col-sm-5">
        <div class="input-group-prepend">
          <span class="input-group-text">Task</span>
        </div>
        <select [disabled]="(studentRequest.memberId==0) || (studentRequest.branchId==0)" class="form-control" [(ngModel)]="taskmapping.taskSelected" name="taskSelected" #taskSelected="ngModel">
          <option value="0" selected disabled>Select Task</option>
          <option *ngFor="let task of taskList;" [value]="task.id" style="text-align: center">
            {{task.name}}</option>
        </select>
      </div>
      <div class="input-group col-sm-2">
        <button class="btn btn-primary" [disabled]="(taskmapping.productSelected == 0) || (taskmapping.taskSelected == 0)" (click)="addTaskToStudent($event)">Add</button>
      </div>
      <div class="col-sm-12">
        <hr>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-12">
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th>Product Name</th>
              <th>Task Details</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let field of studentRequest.tasks; let i = index">
              <td>
                <input [(ngModel)]="field.productName" class="form-control" type="text" name="{{field.productName}}" />
              </td>
              <td>
                <input [(ngModel)]="field.taskName" class="form-control" type="text" name="{{field.taskName}}" />
              </td>
              <td>
                <button class="btn btn-outline-danger" type="button" (click)="deleteFieldValue(i)">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12" style="text-align: right;">
        <div class="form-group">
          <div class="col-sm-12">
            <button type="submit" class="btn btn-primary"
              [disabled]="!studentForm.form.valid || studentRequest.branchId==0 || studentRequest.memberId==0 || studentRequest.tasks.length==0">Submit</button>
            <button type="button" class="btn btn-outline-secondary" (click)="formReset(studentForm);">Reset</button>
          </div>
        </div>
      </div>
    </div>
  </form>

</div>
